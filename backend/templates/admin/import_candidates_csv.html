{% extends 'admin/base_site.html' %}
{% load i18n admin_urls static admin_modify %}
{% block title %}
  {{ title }} | {{ site_title|default:_('Django site admin') }}
{% endblock %}
{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:appAuthentication_candidate_changelist' %}">{{ opts.verbose_name_plural|capfirst|default:'Candidates' }}</a>
    &rsaquo; {{ title }}
  </div>
{% endblock %}
{% block content %}
  <div id="content-main">
    <div class="module aligned">
      <h2>{{ title }}</h2>

      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-row">
          <div>
            <label>Selected Institute:</label>
            {% if selected_institute %}
              <!-- Display selected institute and pass ID as hidden field -->
              <input type="hidden" name="institute_id" value="{{ selected_institute.id }}" />
              <strong>{{ selected_institute.name }}</strong>
              <p class="help">(Selected from previous step)</p>
            {% else %}
              <!-- Fallback if no institute preselected -->
              <select name="institute_id" id="institute_id" required>
                <option value="">Choose an institute...</option>
                {% for institute in institutes %}
                  <option value="{{ institute.id }}">{{ institute.name }}</option>
                {% endfor %}
              </select>
              <p class="help">No institute was selected previously</p>
            {% endif %}
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="csv_file">Select CSV File:</label>
            <input type="file" name="csv_file" id="csv_file" accept=".csv" required />
          </div>
        </div>

        <div class="form-row">
          <div>
            <p class="help">
              <strong>CSV Format Requirements:</strong><br />
              The CSV should contain the following columns in order: S.N, Admit Card ID, Profile ID, Symbol Number, Exam Processing Id, Gender, Citizenship No., Firstname, Middlename, Lastname, DOB (nep), Profile Picture, email, phone, Level ID, Level, Program ID, Program
            </p>
          </div>
        </div>

        <div class="submit-row">
          <input type="submit" value="Import Candidates" class="default" />
          <a href="{% url 'admin:appAuthentication_candidate_changelist' %}" class="button cancel-link">Cancel</a>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
